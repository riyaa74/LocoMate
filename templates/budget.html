<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #ffe3e3;
            background-image: linear-gradient(135deg, #92a8d1, #f7786b);
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin-top: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .section {
            background: #ffffff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease-in-out;
        }
        .section:hover {
            transform: scale(1.02);
        }
        h1 {
            text-align: center;
            color: #111213;
            font-size: 40px;
            font-weight: 600;
        }
        .budget-item, .itenary-item {
            background: #f6d365;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            font-size: 18px;
            text-align: center;
        }
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        button {
            padding: 12px 25px;
            background-color: #0c0c0c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
        }
        button:hover {
            background-color: #022d5f;
            transform: scale(1.05);
        }
        .icon {
            font-size: 20px;
            margin-right: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        h3 {
            color: #333;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Your Trip Summary</h1>
    <div class="container">
        <div class="section" id="budget">
            <h2>üí∞ Estimated Budget</h2>
            <div class="budget-item" id="budget-details">{{ budget }}</div>
        </div>
        <div class="section" id="itenary">
            <h2>üìç Travel Itinerary</h2>
            <div class="itenary-item" id="itenary-details">{{ itinerary }}</div>
        </div>
    </div>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #ffe3e3;
            background-image: linear-gradient(135deg, #92a8d1, #f7786b);
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin-top: 20px;
            display: flex;
            justify-content: space-between;
        }
        .section {
            width: 48%;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
            transition: transform 0.3s ease-in-out;
        }
        .section:hover {
            transform: scale(1.02);
        }
        h1 {
            text-align: center;
            color: #111213;
            font-size: 40px;
            font-weight: 600;
        }
        .budget-item, .itenary-item {
            background: #f6d365;
            padding: 15px;
            margin: 15px 0;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            font-size: 18px;
            text-align: center;
        }
        .buttons-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        button {
            padding: 12px 25px;
            background-color: #0c0c0c;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 16px;
            transition: background-color 0.3s, transform 0.2s;
        }
        button:hover {
            background-color: #022d5f;
            transform: scale(1.05);
        }
        .icon {
            font-size: 20px;
            margin-right: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
        }
        h3 {
            color: #333;
            margin-bottom: 10px;
        }
        .dropdown {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Your Trip Summary</h1>
    <div class="container">
        <div class="section" id="budget">
            <h2>üí∞ Estimated Budget</h2>
            <div id="budget-details"></div>
            <div id="total-estimate"></div>
        </div>
        <div class="section" id="itenary">
            <h2>üìç Travel Itinerary</h2>
            <div class="itenary-item" id="itenary-details">{{ itinerary }}</div>
        </div>
    </div>

    <script>
        const placesData = {
            'Comedy Cellar': {
                'Lower end': {'estimated_cost': 25, 'description': 'This covers the cost of the show ticket, assuming you are willing to stand in line for a chance at standby or purchase a single ticket online if available. Drink purchase during the show is minimal or avoided.'},
                'Mid range': {'estimated_cost': 50, 'description': 'This allows for a guaranteed ticket purchased in advance and a couple of drinks during the show. It also includes potential transportation costs like subway fare.'},
                'High range': {'estimated_cost': 150, 'description': 'This encompasses premium seating purchased far in advance, multiple rounds of drinks (including higher-end options), and transportation via taxi or rideshare. It also allows for potential pre or post-show dinner nearby.'}
            },
            "Carmine's Italian Restaurant - Times Square": {
                'Lower end': {'estimated_cost': 40, 'description': 'This reflects the cost of sharing one family-style dish among a small group or ordering a smaller appetizer and a non-alcoholic beverage. It assumes you are primarily focused on experiencing the atmosphere without ordering extensively.'},
                'Mid range': {'estimated_cost': 80, 'description': 'This covers the cost of sharing a couple of family-style dishes among a group, with each person having a substantial portion, plus a drink each. This allows for a satisfying meal experience without extravagance.'},
                'High range': {'estimated_cost': 150, 'description': "This includes sharing multiple family-style dishes, appetizers, desserts, and alcoholic beverages (wine or cocktails) for a smaller group. It accounts for a luxurious and indulgent dining experience at Carmine's."}
            },
            'Grand Central Terminal': {
                'Lower end': {'estimated_cost': 0, 'description': 'Visiting Grand Central Terminal is free to enter and explore. This cost reflects simply walking through and appreciating the architecture without purchasing anything.'},
                'Mid range': {'estimated_cost': 20, 'description': 'This covers the cost of purchasing a coffee or pastry at one of the many vendors within the terminal. It also allows for a small souvenir or postcard as a memento.'},
                'High range': {'estimated_cost': 100, 'description': "This includes a full meal at one of the terminal's restaurants (like the Oyster Bar) and purchasing multiple souvenirs or gifts from the shops. It allows for a longer, more immersive and indulgent experience at Grand Central."}
            }
        };

        const budgetDetails = document.getElementById('budget-details');

        let totalEstimate = 0;

        for (const place in placesData) {
            const placeCard = document.createElement('div');
            placeCard.className = 'place-card';

            const placeName = document.createElement('h3');
            placeName.textContent = place;
            placeCard.appendChild(placeName);

            const dropdown = document.createElement('select');
            dropdown.className = 'dropdown';
            dropdown.innerHTML = `
                <option value="">Select an option</option>
                <option value="Lower end">Lower end</option>
                <option value="Mid range">Mid range</option>
                <option value="High range">High range</option>
            `;
            placeCard.appendChild(dropdown);

            const costDescription = document.createElement('p');
            placeCard.appendChild(costDescription);

            dropdown.addEventListener('change', function() {
                const selectedOption = dropdown.value;
                const costData = placesData[place][selectedOption];
                costDescription.textContent = `Estimated Cost: $${costData.estimated_cost} - ${costData.description}`;
                totalEstimate += costData.estimated_cost;
                document.getElementById('total-estimate').textContent = `Total Estimate: $${totalEstimate}`;
            });

            budgetDetails.appendChild(placeCard);
        }
    </script>
</body>
</html> -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trip Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #ffe3e3;
            background-image: linear-gradient(135deg, #92a8d1, #f7786b);
        }
        .container {
            width: 90%;
            max-width: 1200px;
            margin-top: 20px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .tabs {
            display: flex;
            justify-content: space-around;
            border-bottom: 2px solid #ddd;
        }
        .tab-button {
            padding: 12px 25px;
            font-size: 16px;
            font-weight: bold;
            border: none;
            background: none;
            cursor: pointer;
            transition: 0.3s ease-in-out;
            border-bottom: 3px solid transparent;
        }
        .tab-button.active {
            border-bottom: 3px solid #f7786b;
            color: #f7786b;
        }
        .tab-content {
            display: none;
            padding: 20px;
        }
        .tab-content.active {
            display: block;
        }
        .budget-table, .itinerary-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .budget-table th, .budget-table td, .itinerary-table th, .itinerary-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .budget-table th, .itinerary-table th {
            background-color: #f2f2f2;
        }
        h2, h3 {
            color: #333;
        }
    </style>
</head>
<body>
    <h1>Your Trip Summary</h1>
    
    <div class="container">
        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="switchTab(event, 'budget-tab')">üí∞ Budget</button>
            <button class="tab-button" onclick="switchTab(event, 'itinerary-tab')">üìç Itinerary</button>
        </div>

        <!-- Budget Tab Content -->
        <div id="budget-tab" class="tab-content active">
            <h2>üí∞ Estimated Budget</h2>
            <div id="budget-details">Fetching budget data...</div>
        </div>

        <!-- Itinerary Tab Content -->
        <div id="itinerary-tab" class="tab-content">
            <h2>üìç Travel Itinerary</h2>
            <div id="itinerary-details">Fetching itinerary data...</div>
        </div>
    </div>

    <script>
        // Function to switch between Budget and Itinerary tabs
        function switchTab(event, tabId) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));

            // Remove 'active' class from all buttons
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));

            // Show the selected tab
            document.getElementById(tabId).classList.add('active');

            // Add 'active' class to the clicked button
            event.currentTarget.classList.add('active');
        }

        // Fetch budget data from Flask
        async function fetchBudget() {
            try {
                const response = await fetch('/budget_send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error('Failed to fetch budget data');
                }

                const data = await response.json();
                renderBudget(data.budget);
            } catch (error) {
                document.getElementById("budget-details").innerHTML = `<p style="color: red;">Error fetching budget data. Please try again later.</p>`;
                console.error("Error fetching budget data:", error);
            }
        }

        function renderBudget(budgetData) {
            const budgetContainer = document.getElementById("budget-details");
            budgetContainer.innerHTML = "";  // Clear previous content

            if (!budgetData || Object.keys(budgetData).length === 0) {
                budgetContainer.innerHTML = `<p style="color: red;">No budget data available.</p>`;
                return;
            }

            for (const location in budgetData) {
                let locationHTML = `<h3>${location}</h3>
                    <table class="budget-table">
                        <tr>
                            <th>Category</th>
                            <th>Estimated Cost</th>
                            <th>Description</th>
                        </tr>`;

                for (const category in budgetData[location]) {
                    const { estimated_cost, description } = budgetData[location][category];
                    locationHTML += `
                        <tr>
                            <td>${category}</td>
                            <td>$${estimated_cost}</td>
                            <td>${description}</td>
                        </tr>`;
                }

                locationHTML += `</table>`;
                budgetContainer.innerHTML += locationHTML;
            }
        }

        // Fetch itinerary data from Flask
        async function fetchItinerary() {
            try {
                const response = await fetch('/itinerary_send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    throw new Error(`Failed to fetch itinerary data. HTTP Status: ${response.status}`);
                }

                const data = await response.json();

                // ‚úÖ Debugging: Print the fetched itinerary data
                console.log("Fetched Itinerary Data:", data);

                if (!data.itinerary) {
                    throw new Error("Invalid itinerary data format received from server.");
                }

                renderItinerary(data.itinerary);
            } catch (error) {
                document.getElementById("itinerary-details").innerHTML = `<p style="color: red;">Error fetching itinerary data. Please try again later.</p>`;
                console.error("Error fetching itinerary data:", error);
            }
        }

        function renderItinerary(itineraryText) {
            const itineraryContainer = document.getElementById("itinerary-details");
            itineraryContainer.innerHTML = "";  // Clear previous content

            if (!itineraryText.trim()) {
                itineraryContainer.innerHTML = `<p style="color: red;">No itinerary data available.</p>`;
                return;
            }

            // Convert newlines into an array of paragraphs
            const lines = itineraryText.split("\n");

            let itineraryHTML = "";
            let isList = false;

            lines.forEach(line => {
                line = line.trim();
                if (!line) return; // Skip empty lines

                if (line.startsWith("**") && line.endsWith("**")) {
                    // **Bold Sections (Phase Titles, Timeframes, etc.)**
                    const sectionTitle = line.replace(/\*\*/g, "");
                    itineraryHTML += `<h3 style="color: #f7786b; margin-top: 15px;">${sectionTitle}</h3>`;
                } else if (line.startsWith("*")) {
                    // * Bullet Points (Actions, Places, Tips) *
                    if (!isList) {
                        itineraryHTML += "<ul>";
                        isList = true;
                    }
                    itineraryHTML += `<li>${line.replace(/\*/g, "").trim()}</li>`;
                } else {
                    // Normal Paragraphs (Descriptions, Details)
                    if (isList) {
                        itineraryHTML += "</ul>"; // Close list before continuing
                        isList = false;
                    }
                    itineraryHTML += `<p style="margin: 5px 0;">${line}</p>`;
                }
            });

            // Close any open lists
            if (isList) {
                itineraryHTML += "</ul>";
            }

            itineraryContainer.innerHTML = itineraryHTML;
        }

        // Fetch data when the page loads
        fetchBudget();
        fetchItinerary();
    </script>
</body>
</html>
